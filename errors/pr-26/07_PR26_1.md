I'll analyze the failing job to find a solution for you. The TypeScript type-check is failing with multiple errors. Let me examine the affected files to understand the issues: ## Solution for TypeScript Compilation Errors

The build is failing due to several TypeScript type errors. Here are the fixes:

### 1. **Fix Commission Route (`app/api/disbursement/affiliates/[affiliateId]/commissions/route.ts`)**

**Problem:** Lines 61, 85, 99, 102-108 - The Prisma schema doesn't have `subscription` or `commissionType` fields on the Commission model.

**Solution:** Remove the `subscription` include and references to `commissionType`. Update lines 54-73 and 96-109:

```typescript
// Replace lines 54-73:
const commissions = await prisma.commission.findMany({
  where: {
    affiliateProfileId: affiliateId,
    status: 'APPROVED',
    disbursementTransaction: null,
  },
  orderBy: { createdAt: 'desc' },
});

// Replace lines 82-91:
const byType: Record<string, { count: number; amount: number }> = {
  default: { count: commissions.length, amount: totalAmount },
};

// Replace lines 96-109:
return NextResponse.json({
  affiliateId,
  affiliateName: affiliate.fullName,
  commissions: commissions.map((c) => ({
    id: c.id,
    amount: Number(c.commissionAmount),
    status: c.status,
    createdAt: c.createdAt,
  })),
  summary: {
    count: commissions.length,
    totalAmount,
    byType,
    oldestCommission:
      commissions.length > 0
        ? commissions[commissions.length - 1]?.createdAt
        : null,
    newestCommission: commissions.length > 0 ? commissions[0]?.createdAt : null,
  },
});
```

### 2. **Fix RiseWorks Accounts Route (`app/api/disbursement/riseworks/accounts/route.ts`)**

**Problem:** Lines 65-66 - The fields `inviteSentAt` and `inviteAcceptedAt` don't exist on the model.

**Solution:** Remove these fields from the response (lines 65-66):

```typescript
// Replace lines 60-76:
accounts:  accounts.map((account) => ({
  id: account.id,
  riseId: account.riseId,
  email: account.email,
  kycStatus: account.kycStatus,
  lastSyncAt: account.lastSyncAt,
  createdAt: account.createdAt,
  affiliate: {
    id: account.affiliateProfile. id,
    fullName: account.affiliateProfile.fullName,
    email: account.affiliateProfile.user.email,
    country: account.affiliateProfile. country,
    status: account. affiliateProfile.status,
  },
})),
```

### 3. **Fix Retry Handler (`lib/disbursement/services/retry-handler.ts`)**

**Problem:** Lines 72 and 141 - Type mismatch with literal type `3` vs `number`.

**Solution:** Change the RetryConfig interface to use `number` instead of literal types. Update lines 19-24:

```typescript
export interface RetryConfig {
  maxAttempts: number;
  initialDelay: number;
  maxDelay: number;
  backoffMultiplier: number;
}
```

Also check your `lib/disbursement/constants.ts` file and ensure `DEFAULT_RETRY_CONFIG` doesn't use `as const`:

```typescript
export const DEFAULT_RETRY_CONFIG: RetryConfig = {
  maxAttempts: 3,
  initialDelay: 1000,
  maxDelay: 30000,
  backoffMultiplier: 2,
};
```

### 4. **Fix Transaction Logger (`lib/disbursement/services/transaction-logger.ts`)**

**Problem:** Line 42 - Type mismatch for the `details` field with Prisma's JSON type.

**Solution:** Cast the details to the correct type on line 42:

```typescript
details: (entry. details ??  {}) as any,
```

Or better yet, update line 42 to:

```typescript
details: entry.details ?  JSON.parse(JSON.stringify(entry.details)) : {},
```

After applying these fixes, the TypeScript compilation should succeed.
