I'll analyze the failing job to find a solution for you. ## Solution for Failing Job 58668280706

The build is failing because the `subscription` field doesn't exist on the `Commission` model's include type. The error occurs at line 61 in the file.

**Root Cause:**
The code is trying to include a `subscription` relation on the `Commission` model, but this relation isn't defined in your Prisma schema.

**Solution:**

You need to check your Prisma schema and determine the correct relation name. Based on typical commission tracking patterns, the relation might be named differently. Here are two possible fixes:

### Option 1: If the relation exists but has a different name

Check your `prisma/schema.prisma` file for the `Commission` model and use the correct relation field name. Replace `subscription` with the actual field name (it might be something like `Subscription`, `referredSubscription`, or `subscriptionRef`).

### Option 2: If the relation doesn't exist

You'll need to either:

**A) Remove the subscription include** (lines 61-72):

```typescript
const commissions = await prisma.commission.findMany({
  where: {
    affiliateProfileId: affiliateId,
    status: 'APPROVED',
    disbursementTransaction: null,
  },
  // Remove the include block entirely
  orderBy: { createdAt: 'desc' },
});
```

And update the response mapping (lines 102-108) to remove references to `c.subscription`:

```typescript
commissions: commissions.map((c) => ({
  id: c.id,
  amount: Number(c.commissionAmount),
  type: c.commissionType,
  status: c.status,
  createdAt: c.createdAt,
  referredUser: null,
  subscriptionTier: null,
})),
```

**B) Add the missing relation to your Prisma schema** if you need this data:

```prisma
model Commission {
  // ... other fields
  subscription   Subscription?  @relation(fields: [subscriptionId], references: [id])
  subscriptionId String?
}
```

Then run `prisma generate` to update the types.

**Recommended Action:** Check your Prisma schema first to see what relations are available on the `Commission` model, then apply the appropriate fix.
