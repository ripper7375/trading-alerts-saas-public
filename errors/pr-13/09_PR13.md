I'll analyze the failing job to find a solution for you. I can see the TypeScript compilation is failing with several errors. Let me examine the affected files: ## Solution for Failing TypeScript Build

The job is failing due to **5 TypeScript errors**. Here's how to fix them:

### 1. **CRON_SECRET Property Access (3 errors)**

TypeScript is enforcing stricter index signature access. Change the property access syntax in 3 files:

**`app/api/cron/distribute-codes/route.ts` (line 47):**

```typescript
// Change from:
const cronSecret = process.env.CRON_SECRET;

// To:
const cronSecret = process.env['CRON_SECRET'];
```

**`app/api/cron/expire-codes/route.ts` (line 44):**

```typescript
// Change from:
const cronSecret = process.env.CRON_SECRET;

// To:
const cronSecret = process.env['CRON_SECRET'];
```

**`app/api/cron/send-monthly-reports/route. ts` (line 110):**

```typescript
// Change from:
const cronSecret = process.env.CRON_SECRET;

// To:
const cronSecret = process.env['CRON_SECRET'];
```

### 2. **Missing Prisma Model (line 63 in send-monthly-reports/route.ts)**

The code references `prisma.affiliateCommission` which doesn't exist in your Prisma schema. Change line 63:

```typescript
// Change from:
const commissions = await prisma.affiliateCommission.aggregate({

// To:
const commissions = await prisma.commission.aggregate({
```

### 3. **Decimal Type Mismatch (line 174 in send-monthly-reports/route.ts)**

`affiliate.pendingCommissions` returns a Prisma `Decimal` type but needs to be converted to a number. Change line 174:

```typescript
// Change from:
balance: affiliate.pendingCommissions,

// To:
balance: affiliate.pendingCommissions.toNumber(),
```

These changes will resolve all TypeScript compilation errors and allow the build to pass.
