The CI job is failing due to two main issues:

1. **TypeScript error in `page.tsx`**
   - Error: `Type 'string | undefined' is not assignable to type 'string'.`
   - **Solution:**  
     Update the usage of the `token` variable, which is retrieved using `searchParams.get('token')` and can be `undefined`. Safely handle the possible `undefined` value:

     ```tsx
     const token = searchParams.get('token') ?? '';
     ```

     If an empty string is invalid for your logic, add conditional handling where you use `token`.

2. **Missing properties on the `User` type in several API routes**  
   Errors such as:
   - `Property 'twoFactorEnabled' does not exist on type 'User'.`
   - `Property 'twoFactorSecret' does not exist on type 'User'.`
   - `Property 'twoFactorBackupCodes' does not exist on type 'User'.`
   - `Property 'twoFactorVerifiedAt' does not exist on type 'User'.`

   These errors occur in files like:
   - `app/api/user/2fa/backup-codes/route.ts`
   - `app/api/user/2fa/disable/route.ts`
   - `app/api/user/2fa/setup/route.ts`
   - `app/api/user/2fa/verify-setup/route.ts`
   - `app/api/user/2fa/verify/route.ts`
   - [`lib/auth/auth-options.ts`](https://github.com/ripper7375/trading-alerts-saas-public/blob/8a80d2c6a327b3b1d0096197f0c5c66f6b25412a/lib/auth/auth-options.ts#L225)

   **Solution:**  
   Extend your `User` type (likely from `@prisma/client` or custom) in your `next-auth` and API files to include the required 2FA fields. For example:

   ```typescript
   // Wherever you define your User type override, e.g. in a types file or at the top of affected files:
   interface User {
     twoFactorEnabled?: boolean;
     twoFactorSecret?: string | null;
     twoFactorBackupCodes?: string | null;
     twoFactorVerifiedAt?: Date | null;
     // ...other existing fields
   }
   ```

   If you are using Prisma, check that your database schema includes these fields on the User model:

   ```prisma
   model User {
     id                    String   @id @default(uuid())
     email                 String   @unique
     // ...other fields...
     twoFactorEnabled      Boolean  @default(false)
     twoFactorSecret       String?
     twoFactorBackupCodes  String?
     twoFactorVerifiedAt   DateTime?
   }
   ```

   After updating your schema, run `prisma generate` and possibly a database migration:

   ```sh
   npx prisma migrate dev
   ```

   Then, ensure your TypeScript types are up-to-date everywhere you reference `User`.

---

**Summary of fixes for the commit [`8a80d2c6a327b3b1d0096197f0c5c66f6b25412a`](https://github.com/ripper7375/trading-alerts-saas-public/commit/8a80d2c6a327b3b1d0096197f0c5c66f6b25412a):**

- Make sure the 2FA-related fields exist in the User type and your database schema.
- Handle possible `undefined` values from query parameters properly.

Once you address these, the job should pass.
