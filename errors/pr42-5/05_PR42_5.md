The failure comes from **tests**/lib/db/prisma.test.ts, specifically this assertion:

```typescript
expect(mockPrismaClient).toHaveBeenCalled();
```

This checks that the PrismaClient constructor (mocked by jest) was called when importing the prisma singleton.

However, your code in lib/db/prisma.ts imports PrismaClient from '.prisma/client', while your jest.mock in the test mocks '@prisma/client'. This means the mock isn't applied, so mockPrismaClient is never calledâ€”causing the test to fail.

**Solution:**  
Update the jest.mock path in your test to match the actual import in lib/db/prisma.ts:

Replace in **tests**/lib/db/prisma.test.ts:

```typescript
jest.mock('@prisma/client', () => ({
  __esModule: true,
  PrismaClient: mockPrismaClient,
}));
```

with:

```typescript
jest.mock('.prisma/client', () => ({
  __esModule: true,
  PrismaClient: mockPrismaClient,
}));
```

This ensures your mock is used, fixing the test.

See relevant files:

- Test: **tests**/lib/db/prisma.test.ts (ref: e658480707057c52b3ddcea1dd1bd03502dc7cfc)
- Implementation: lib/db/prisma.ts (ref: e658480707057c52b3ddcea1dd1bd03502dc7cfc)
