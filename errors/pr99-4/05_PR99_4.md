The failing test is in **tests**/api/indicators.test.ts and checks the handling of MT5ServiceError. The log shows:

Expected: "MT5 service error"
Received: "Internal server error"

This means in your API route for /api/indicators/[symbol]/[timeframe], when fetchIndicatorData throws an MT5ServiceError, the handler is returning "Internal server error" rather than "MT5 service error".

To fix this, in your error handling for the GET /api/indicators/[symbol]/[timeframe] route (likely app/api/indicators/[symbol]/[timeframe]/route.ts), adjust the code that handles exceptions from fetchIndicatorData. Specifically, catch MT5ServiceError and respond with the correct message (ERROR_MESSAGES.MT5_SERVICE). Your test expects ERROR_MESSAGES.MT5_SERVICE as the error string.

Suggested fix:

Find the error handling in the GET handler (app/api/indicators/[symbol]/[timeframe]/route.ts) and change:

```typescript
if (error instanceof MT5ServiceError) {
  // Change this block to return the right error message and code
  return NextResponse.json(
    { success: false, error: ERROR_MESSAGES.MT5_SERVICE },
    { status: 500 }
  );
}
```

Make sure ERROR_MESSAGES.MT5_SERVICE matches "MT5 service error" or adjust accordingly. This will make the API response align with the test expectation.

Reference:

- Failing test: **tests**/api/indicators.test.ts:438-462 (ref: 2f2341a4ce6dd14a40b9cdf61415f6c677ff353c)
