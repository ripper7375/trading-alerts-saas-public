The failing job is caused by test failures in **tests**/api/indicators.test.ts, specifically in the tests for how GET /api/indicators/[symbol]/[timeframe] handles error situations. The failing tests are:

- Test expecting status 500 and error "MT5 service error" when fetchIndicatorData throws MT5ServiceError.
- Test expecting status 500 and error "Internal server error" for unknown errors.

Reviewing your route handler in app/api/indicators/[symbol]/[timeframe]/route.ts, your error handling appears correct and matches what the tests expect:

- For MT5ServiceError, you return error: 'MT5 service error', status: 500.
- For unknown errors, you return error: 'Internal server error', status: 500.

Possible causes for persistent test failure:

1. The logic may not be properly distinguishing between MT5ServiceError and other generic errors, due to how error instances are generated by mocks or the import setup.
2. The test mock or module path might be mismatched, causing error instanceof checks to fail. For example, if the MT5ServiceError class in the test is not the same as the handler's due to jest.mock usage, instanceof will return false, triggering the generic error response rather than the specific one.

Solution:
Update your error handling to check the error name property as well as instanceof, increasing robustness to mock mismatches in tests.

Modify your catch block in route.ts as follows:

```typescript
catch (error) {
  // Also check for error.name to support test mocks
  if (
    error instanceof MT5ServiceError ||
    error?.name === 'MT5ServiceError'
  ) {
    // ... unchanged MT5 service error response
  }
  if (
    error instanceof MT5AccessDeniedError ||
    error?.name === 'MT5AccessDeniedError'
  ) {
    // ... unchanged tier denied response
  }
  // ... unchanged unknown error response
}
```

This ensures that both real and mocked errors trigger the correct responses, and should make your tests pass. For a more targeted patch, focus this change on the error handling starting at line 360 in app/api/indicators/[symbol]/[timeframe]/route.ts (ref: 0efe40b71d2f791d57b059928d40708fb94645c3).
