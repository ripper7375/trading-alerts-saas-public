I'll analyze the failing job to find a solution. Let me get the logs first. The type check is failing with multiple TypeScript errors. Let me examine the affected files to understand the context better: ## Solution for TypeScript Compilation Errors

The build is failing due to multiple TypeScript strict null-checking and index signature errors. Here are the fixes:

### 1. **app/api/admin/users/route.ts** (Line 46)

Remove the unused `PrismaUserWithCounts` interface:

```typescript
// Delete lines 46-58 (the entire PrismaUserWithCounts interface)
```

### 2. **lib/cron/check-expiring-subscriptions.ts** (Lines 103, 120-122, 129)

Add null checks for `subscription. user`:

```typescript
// Replace lines 103-133 with:
if (!subscription.user || !subscription.user.email || !subscription.expiresAt) {
  logger.warn('Skipping subscription - missing user, email or expiry', {
    subscriptionId: subscription.id,
  });
  continue;
}

// Mark reminder as sent (unless dry run)
if (!dryRun) {
  await prisma.subscription.update({
    where: { id: subscription.id },
    data: { renewalReminderSent: true },
  });
}

// Add to reminders list for email sending
result.reminders.push({
  userId: subscription.user.id,
  email: subscription.user.email,
  name: subscription.user.name,
  expiresAt: subscription.expiresAt,
  subscriptionId: subscription.id,
  planType: subscription.planType,
});

logger.info('Renewal reminder marked for sending', {
  userId: subscription.user.id,
  subscriptionId: subscription.id,
  expiresAt: subscription.expiresAt,
  dryRun,
});
```

### 3. **lib/disbursement/services/batch-manager.ts** (Lines 162-173, 354-361)

Use bracket notation for index signature properties:

```typescript
// Lines 162-173:
case 'PROCESSING':
  updateData['executedAt'] = new Date();
  break;
case 'COMPLETED':
  updateData['completedAt'] = new Date();
  break;
case 'FAILED':
  updateData['failedAt'] = new Date();
  updateData['errorMessage'] = errorMessage;
  break;
case 'CANCELLED':
  updateData['failedAt'] = new Date();
  updateData['errorMessage'] = errorMessage || 'Batch cancelled';
  break;

// Lines 352-361:
const byStatus: Record<string, number> = {};
for (const item of statusCounts) {
  byStatus[item.status] = item['_count'] as number;
}

return {
  total: batches['_count'] as number,
  byStatus,
  totalAmount: Number(batches['_sum']?.totalAmount ?? 0),
  totalPayments: (batches['_sum']?.paymentCount ?? 0) as number,
};
```

Apply similar fixes to the remaining files with the same patterns:

- Add null checks before accessing potentially undefined properties (`.user`, `.commissions`, `.transactions`)
- Use bracket notation `['propertyName']` for properties accessed via index signatures (`_sum`, `_count`, `status`)
