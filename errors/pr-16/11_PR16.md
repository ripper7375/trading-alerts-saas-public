I'll analyze the failing job to find a solution. Let me get the logs first. Now let me get the failing files to provide specific solutions: ## TypeScript Errors Solution

The job is failing due to several TypeScript errors. Here are the fixes needed:

### 1. **app/(dashboard)/admin/fraud-alerts/[id]/page.tsx**

**Line 101:** Remove unused `router` variable

```tsx
// Remove this line:
const router = useRouter();
```

**Line 122:** Access `params.id` using bracket notation

```tsx
// Change from:
}, [params.id]);

// To:
}, [params['id']]);
```

### 2. **app/(dashboard)/admin/fraud-alerts/page.tsx**

**Lines 17, 20:** Remove unused imports

```tsx
// Change from:
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { FraudAlertCard } from '@/components/admin/FraudAlertCard';
import { FraudPatternBadge } from '@/components/admin/FraudPatternBadge';

// To:
import { Card, CardContent } from '@/components/ui/card';
import { Button } from '@/components/ui/button';
import { FraudAlertCard } from '@/components/admin/FraudAlertCard';
```

### 3. **app/api/payments/dlocal/check-three-day-eligibility/route.ts**

**Line 24:** Remove unused `request` parameter

```typescript
// Change from:
export async function GET(request: NextRequest): Promise<NextResponse> {

// To:
export async function GET(): Promise<NextResponse> {
```

### 4. **app/api/payments/dlocal/validate-discount/route.ts**

**Lines 83-104:** Fix Prisma query - remove invalid `affiliate` property and use correct field name

```typescript
// Change from (lines 82-89):
include: {
  affiliate: {
    select: {
      id:  true,
      status: true,
    },
  },
},

// To:
include: {
  affiliateProfile: {
    select: {
      id: true,
      status: true,
    },
  },
},
```

Then update the references (lines 101-104):

```typescript
// Change from:
if (affiliateCode. affiliate?. status !== 'ACTIVE') {
  logger.info('Affiliate not active', {
    code: normalizedCode,
    affiliateId: affiliateCode.affiliateId,
  });

// To:
if (affiliateCode.affiliateProfile?.status !== 'ACTIVE') {
  logger.info('Affiliate not active', {
    code: normalizedCode,
    affiliateId:  affiliateCode.affiliateProfileId,
  });
```

### 5. **components/payments/PaymentMethodSelector.tsx**

**Lines 227, 237:** Add null checks for `apiMethods` and `fallbackMethods`

```tsx
// Line 218-220, change to:
if (!value && apiMethods.length > 0) {
  onChange(apiMethods[0]!.id);
}

// Line 227-228, change to:
if (!value && fallbackMethods.length > 0) {
  onChange(fallbackMethods[0]!.id);
}

// Line 237-238, change to:
if (!value && fallbackMethods.length > 0) {
  onChange(fallbackMethods[0]!.id);
}
```

These fixes will resolve all the TypeScript compilation errors and allow the tests workflow to pass.
