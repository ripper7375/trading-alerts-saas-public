The job is failing because your test expects an MT5 service failure to return error: 'MT5 service error', but the actual response contains error: 'Internal server error'.

The relevant test (**tests**/api/indicators.test.ts, lines 435–459) expects that when fetchIndicatorData throws MT5ServiceError, the response should include error: 'MT5 service error'. Your handler (app/api/indicators/[symbol]/[timeframe]/route.ts) is mostly correct, and it does check for MT5ServiceError. However, it relies on instanceof checks, which will fail for mocked classes in Jest, causing it to fall through to the generic error block and return 'Internal server error'.

**Solution:**  
Update the error-handling logic in app/api/indicators/[symbol]/[timeframe]/route.ts so that it recognizes MT5ServiceError objects even if they come from Jest mocks. Instead of checking only instanceof, also check error.name or the existence of a statusCode property.

Find this section (starting line 515):

```typescript
const isMT5ServiceError =
  error instanceof MT5ServiceError ||
  (error instanceof Error &&
    'statusCode' in error &&
    typeof (error as MT5ServiceError).statusCode === 'number');

if (isMT5ServiceError) {
  // ... returns MT5 service error
}
```

**If this block is not triggering for Jest mocks, double-check if error.name === 'MT5ServiceError' and use that as an additional condition:**

```typescript
const isMT5ServiceError =
  error instanceof MT5ServiceError ||
  (error instanceof Error &&
    (error.name === 'MT5ServiceError' ||
      ('statusCode' in error &&
        typeof (error as any).statusCode === 'number')));

if (isMT5ServiceError) {
  // ... returns MT5 service error
}
```

**Summary:**  
Add or improve the fallback check for error.name or statusCode so Jest mocks for MT5ServiceError are picked up. This will make your error response match the test’s expected output.

For reference, see:

- The error-handling block in route.ts ([ref](https://github.com/ripper7375/trading-alerts-saas-public/blob/d977f40e80fa062ff6d3c8ace1dcf1e61aaab5e3/app/api/indicators/[symbol]/[timeframe]/route.ts))
- The test expectations in indicators.test.ts ([ref](https://github.com/ripper7375/trading-alerts-saas-public/blob/d977f40e80fa062ff6d3c8ace1dcf1e61aaab5e3/__tests__/api/indicators.test.ts))

This change will fix your failing test and align runtime and test environments.
