The failing job 59002348247 in your CI detected a test failure in the Indicators API. Specifically, the test for “GET /api/indicators/[symbol]/[timeframe] › should return indicator data for FREE tier with valid symbol/timeframe” failed.

Based on the code in app/api/indicators/[symbol]/[timeframe]/route.ts (ref: e6ad77f04796f96d0b329545bb9a6d2b294cd065), the GET handler performs authentication, parameter validation, and fetches data from the MT5 service. If authentication or tier validation fails, the route returns appropriate errors.

**Likely Causes and Solutions:**

1. **MT5 Service Error or Data Fetch Failure**
   - If fetchIndicatorData throws an error or returns unexpected data (such as null or missing properties), your test will fail. Ensure that:
     - The Flask MT5 service is operational during CI.
     - All expected fields are present in the mock response and in production.

2. **Mocks Not Aligned With Implementation**
   - The test heavily mocks dependencies. Make sure mockFetchIndicatorData resolves to an object with all required keys, including proIndicatorsTransformed.

     Example fix:

     ```typescript
     const mockData = {
       ohlc: [...],
       horizontal: {...},
       diagonal: {...},
       fractals: {...},
       metadata: {...},
       proIndicators: {},
       proIndicatorsTransformed: {}, // Ensure this is included
     };
     mockFetchIndicatorData.mockResolvedValue(mockData);
     ```

3. **Zod Validation Failing**
   - Confirm symbol/timeframe values in tests are valid and match schema in the route handler.

4. **Authorization**
   - Ensure the test mocks FREE tier as shown and that the session is injected properly.

**Action to Fix:**

- Check that your mockFetchIndicatorData in the test file always returns an object with all keys expected by the endpoint, including proIndicators and proIndicatorsTransformed.
- Ensure no schema validation is unmet in both the handler and the tests.

With these corrections, your test and job should pass. For reference, see the relevant test at **tests**/api/indicators.test.ts (ref: e6ad77f04796f96d0b329545bb9a6d2b294cd065) and the API handler at app/api/indicators/[symbol]/[timeframe]/route.ts (same ref).
